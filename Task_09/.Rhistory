setwd(~/Desktop/Evolution/Tasks/Task_09)
setwd('~/Desktop/Evolution/Tasks/Task_09')
library(diversitree)
transition_0to1 <- 0.1
transition_1to0 <- 0.1
speciation_0 <- 0.2
extinction_0 <- 0.1
speciation_1 <- 0.2
extinction_1 <- 0.1
maxN <- 1e3
maxT <- 50
Pars <- c(speciation_0, speciation_1, extinction_0, extinction_1, transition_0to1, transition_1to0)
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
str(simTree)
?tree.bisse
simTree
plot(simTree)
stateTable <- table(simTree$tip.state)
stateTable / sum(stateTable)
transition_range <- seq(0.1, 0.9, 0.05)
sim_results <- list()
for (i in seq_along(transition_range)) {
Pars[5] <- transition_range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results[[i]] <- simTree
}
library(diversitree)
for (i in seq_along(transition_range)) {
Pars[5] <- transition_range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results[[i]] <- simTree
}
state_tables <- lapply(sim_results, function(tree) table(tree$tip.state) / sum(tree$tip.state))
View(state_tables)
state_tables
setwd('~/Desktop/Evolution/Tasks/Task_09')
transition_0to1 <- 0.1
transition_1to0 <- 0.1
speciation_0 <- 0.2
extinction_0 <- 0.1
speciation_1 <- 0.2
extinction_1 <- 0.1
maxN <- 1e3
maxT <- 50
Pars <- c(speciation_0, speciation_1, extinction_0, extinction_1, transition_0to1, transition_1to0)
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
str(simTree)
?tree.bisse
simTree
plot(simTree)
stateTable <- table(simTree$tip.state)
stateTable / sum(stateTable)
speciation_1_range <- seq(0.1, 0.9, 0.1)
sim_results <- list()
for (i in seq_along(speciation_1_range)) {
Pars[2] <- speciation_1_range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results[[i]] <- simTree
}
state_tables <- lapply(sim_results, function(tree) table(tree$tip.state) / sum(tree$tip.state))
# Create an empty data frame to store the results
results_df <- data.frame(speciation_1 = speciation_1_range, tip_state_0 = rep(0, length(speciation_1_range)), tip_state_1 = rep(0, length(speciation_1_range)))
# Populate the data frame with state table information from each simulation
for (i in seq_along(sim_results)) {
state_table <- state_tables[[i]]
results_df$tip_state_0[i] <- state_table[1]
results_df$tip_state_1[i] <- state_table[2]
}
# Create a line plot to show how tip state frequencies change with speciation_1
library(ggplot2)
ggplot(results_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
ggplot(state_table, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
state_tables
View(state_tables)
ggplot(state_tables, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
rm(results_df)
par(mfrow=c(2,5))
for (i in seq_along(sim_results)) {
plot(sim_results[[i]])
title(paste0("Speciation_1 = ", speciation_1_range[i]))
}
ggtree_obj <- lapply(sim_results, as_treedata)
speciation_1range <- seq(0.1, 0.9, 0.1)
sim_results <- list()
for (i in seq_along(speciation_1range)) {
Pars[2] <- speciation_1range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results[[i]] <- simTree
}
state_tables <- lapply(sim_results, function(tree) table(tree$tip.state) / sum(tree$tip.state))
rm(speciation_1_range)
View(state_tables)
state_tables
y_vals <- unlist(state_tables)
x_vals <- seq_along(state_tables)
plot(x_vals, y_vals, type = "l", xlab = "Index", ylab = "Value")
rm(x_vals)
rm(y_vals)
df <- do.call(rbind, state_tables)
df <- data.frame(speciation_1 = rep(seq(0.1, 0.9, 0.1), each = 3),
state = rep(c(0, 1, "both"), 9),
proportion = df$Freq)
rm(df)
results_df <- data.frame(speciation_1 = speciation_1range, tip_state_0 = rep(0, length(speciation_1range)), tip_state_1 = rep(0, length(speciation_1range)))
for (i in seq_along(sim_results)) {
state_table <- state_tables[[i]]
results_df$tip_state_0[i] <- state_table[1]
results_df$tip_state_1[i] <- state_table[2]
}
ggplot(results_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
df <- data.frame(speciation_1 = speciation_1range, tip_state_0 = rep(0, length(speciation_1range)), tip_state_1 = rep(0, length(speciation_1range)))
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
for (i in seq_along(sim_results)) {
state_table <- state_tables[[i]]
df$tip_state_0[i] <- state_table[1]
df$tip_state_1[i] <- state_table[2]
}
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
?data.frame
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "pink", "Tip state 1" = "black")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "#002340", "Tip state 1" = "black")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "gray", "Tip state 1" = "black")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "darkgray", "Tip state 1" = "black")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0", linetype = "dotted")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "darkgray", "Tip state 1" = "black")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
rm(df)
rm(results_df)
rm(state_tables)
Pars
?tree.bisse
str(simTree)
speciation_0 <- c(0.2, 0.3)
Pars <- c(speciation_0, speciation_1, extinction_0, extinction_1, transition_0to1, transition_1to0)
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
speciation_0 <- 0.2
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
Pars <- c(speciation_0, speciation_1, extinction_0, extinction_1, transition_0to1, transition_1to0)
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
speciation_1range <- seq(0.1, 0.9, 0.1)
sim_results <- list()
i <-1
for (i in seq_along(speciation_1_range)) {
Pars[2] <- speciation_1_range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results[[i]] <- simTree
}
for (i in seq_along(speciation_1range)) {
Pars[2] <- speciation_1_range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results[[i]] <- simTree
}
for (i in seq_along(speciation_1range)) {
Pars[2] <- speciation_1range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results[[i]] <- simTree
}
state_tables <- lapply(sim_results, function(tree) table(tree$tip.state) / sum(tree$tip.state))
state_tables
df <- data.frame(speciation_1 = speciation_1_range, tip_state_0 = rep(0, length(speciation_1_range)), tip_state_1 = rep(0, length(speciation_1_range)))
df <- data.frame(speciation_1 = speciation_1range, tip_state_0 = rep(0, length(speciation_1range)), tip_state_1 = rep(0, length(speciation_1range)))
for (i in seq_along(sim_results)) {
state_table <- state_tables[[i]]
df$tip_state_0[i] <- state_table[1]
df$tip_state_1[i] <- state_table[2]
}
ggplot(results_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
for (i in seq_along(speciation_1range)) {
Pars[2] <- speciation_1range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results[[i]] <- simTree
}
state_tables <- lapply(sim_results, function(tree) table(tree$tip.state) / sum(tree$tip.state))
df <- data.frame(speciation_1 = speciation_1range, tip_state_0 = rep(0, length(speciation_1range)), tip_state_1 = rep(0, length(speciation_1range)))
for (i in seq_along(sim_results)) {
state_table <- state_tables[[i]]
df$tip_state_0[i] <- state_table[1]
df$tip_state_1[i] <- state_table[2]
}
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
df
for (i in seq_along(speciation_1range)) {
Pars[2] <- speciation_1range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results[[i]] <- simTree
}
state_tables <- lapply(sim_results, function(tree) table(tree$tip.state) / sum(tree$tip.state))
df <- data.frame(speciation_1 = speciation_1range, tip_state_0 = rep(0, length(speciation_1range)), tip_state_1 = rep(0, length(speciation_1range)))
for (i in seq_along(sim_results)) {
state_table <- state_tables[[i]]
df$tip_state_0[i] <- state_table[1]
df$tip_state_1[i] <- state_table[2]
}
ggplot(df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
df
nona_df <- na.omit(df)
nona_df
ggplot(nona_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip state 0")) +
geom_line(aes(y = tip_state_1, color = "Tip state 1")) +
scale_color_manual(values = c("Tip state 0" = "blue", "Tip state 1" = "red")) +
xlab("Speciation rate for state 1 (speciation_1)") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
ggplot(nona_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip State 0")) +
geom_line(aes(y = tip_state_1, color = "Tip State 1")) +
scale_color_manual(values = c("Tip State 0" = "blue", "Tip State 1" = "black")) +
xlab("Speciation Rate for State 1") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw()
ggplot(nona_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip State 0")) +
geom_line(aes(y = tip_state_1, color = "Tip State 1")) +
scale_color_manual(values = c("Tip State 0" = "blue", "Tip State 1" = "black")) +
xlab("Speciation Rate for State 1") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
labs(fill = "Tip States") +
theme_bw()
ggplot(nona_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip State 0")) +
geom_line(aes(y = tip_state_1, color = "Tip State 1")) +
scale_color_manual(values = c("Tip State 0" = "blue", "Tip State 1" = "black")) +
xlab("Speciation Rate for State 1") +
ylab("Tip state frequency") +
ggtitle("Effect of speciation_1 on tip state frequencies") +
theme_bw() +
labs(color = "Tip States")
ggplot(nona_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip State 0")) +
geom_line(aes(y = tip_state_1, color = "Tip State 1")) +
scale_color_manual(values = c("Tip State 0" = "blue", "Tip State 1" = "black")) +
xlab("Speciation Rate for State 1") +
ylab("Tip state frequency") +
ggtitle("Effect of Varying Speciation on Tip State Frequency") +
theme_bw() +
labs(color = "Tip States")
ggplot(nona_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip State 0")) +
geom_line(aes(y = tip_state_1, color = "Tip State 1")) +
scale_color_manual(values = c("Tip State 0" = "blue", "Tip State 1" = "black")) +
xlab("Speciation Rate for State 1") +
ylab("Tip State Frequency") +
ggtitle("Effect of Varying Speciation on Tip State Frequency") +
theme_bw() +
labs(color = "Tip States")
nona_df
speciation_0range <- seq(0.1, 0.9, 0.1)
sim_results2 <- list()
for (i in seq_along(speciation_0range)) {
Pars[2] <- speciation_0range[i]
simTree <- tree.bisse(Pars, max.taxa = maxN, max.t = maxT)
sim_results2[[i]] <- simTree
}
state_tables2 <- lapply(sim_results, function(tree) table(tree$tip.state) / sum(tree$tip.state))
state_tables2
df2 <- data.frame(speciation_1 = speciation_0range, tip_state_0 = rep(0, length(speciation_0range)), tip_state_1 = rep(0, length(speciation_0range)))
for (i in seq_along(sim_results2)) {
state_table <- state_tables2[[i]]
df2$tip_state_0[i] <- state_table[1]
df2$tip_state_1[i] <- state_table[2]
}
nona_df2 <- na.omit(df2)
nona_df2
ggplot(nona_df2, aes(x = speciation_0)) +
geom_line(aes(y = tip_state_0, color = "Tip State 0")) +
geom_line(aes(y = tip_state_1, color = "Tip State 1")) +
scale_color_manual(values = c("Tip State 0" = "blue", "Tip State 1" = "black")) +
xlab("Speciation Rate for State 1") +
ylab("Tip State Frequency") +
ggtitle("Effect of Varying Speciation on Tip State Frequency") +
theme_bw() +
labs(color = "Tip States")
nona_df
ggplot(nona_df, aes(x = speciation_1)) +
geom_line(aes(y = tip_state_0, color = "Tip State 0")) +
geom_line(aes(y = tip_state_1, color = "Tip State 1")) +
scale_color_manual(values = c("Tip State 0" = "blue", "Tip State 1" = "black")) +
xlab("Speciation Rate for State 1") +
ylab("Tip State Frequency") +
ggtitle("Effect of Varying Speciation on Tip State Frequency") +
theme_bw() +
labs(color = "Tip States")
